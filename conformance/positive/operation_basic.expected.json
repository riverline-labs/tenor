{
  "constructs": [
    {
      "id": "is_active",
      "kind": "Fact",
      "provenance": { "file": "operation_basic.tenor", "line": 15 },
      "source": { "field": "active", "system": "account_service" },
      "tenor": "0.3",
      "type": { "base": "Bool" }
    },
    {
      "id": "Order",
      "initial": "draft",
      "kind": "Entity",
      "provenance": { "file": "operation_basic.tenor", "line": 5 },
      "states": ["draft", "submitted", "approved", "rejected"],
      "tenor": "0.3",
      "transitions": [
        { "from": "draft", "to": "submitted" },
        { "from": "submitted", "to": "approved" },
        { "from": "submitted", "to": "rejected" }
      ]
    },
    {
      "body": {
        "produce": {
          "payload": { "type": { "base": "Bool" }, "value": true },
          "verdict_type": "account_active"
        },
        "when": {
          "left": { "fact_ref": "is_active" },
          "op": "=",
          "right": { "literal": true, "type": { "base": "Bool" } }
        }
      },
      "id": "account_active",
      "kind": "Rule",
      "provenance": { "file": "operation_basic.tenor", "line": 20 },
      "stratum": 0,
      "tenor": "0.3"
    },
    {
      "allowed_personas": ["reviewer", "admin"],
      "effects": [
        { "entity_id": "Order", "from": "submitted", "to": "approved" }
      ],
      "error_contract": ["precondition_failed", "persona_rejected"],
      "id": "approve_order",
      "kind": "Operation",
      "precondition": { "verdict_present": "account_active" },
      "provenance": { "file": "operation_basic.tenor", "line": 33 },
      "tenor": "0.3"
    },
    {
      "allowed_personas": ["reviewer", "admin"],
      "effects": [
        { "entity_id": "Order", "from": "submitted", "to": "rejected" }
      ],
      "error_contract": ["precondition_failed", "persona_rejected"],
      "id": "reject_order",
      "kind": "Operation",
      "precondition": { "verdict_present": "account_active" },
      "provenance": { "file": "operation_basic.tenor", "line": 40 },
      "tenor": "0.3"
    },
    {
      "allowed_personas": ["buyer"],
      "effects": [
        { "entity_id": "Order", "from": "draft", "to": "submitted" }
      ],
      "error_contract": ["precondition_failed", "persona_rejected"],
      "id": "submit_order",
      "kind": "Operation",
      "precondition": { "verdict_present": "account_active" },
      "provenance": { "file": "operation_basic.tenor", "line": 26 },
      "tenor": "0.3"
    }
  ],
  "id": "operation_basic",
  "kind": "Bundle",
  "tenor": "0.3"
}
