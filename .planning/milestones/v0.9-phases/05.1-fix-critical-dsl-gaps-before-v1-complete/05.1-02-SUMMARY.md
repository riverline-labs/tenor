---
phase: 05.1-fix-critical-dsl-gaps-before-v1-complete
plan: 02
status: complete
duration: 6min
tasks_completed: 2
---

# Plan 05.1-02: Exists Quantifier (Bounded Existential Quantification)

## What was built

1. Full `exists` quantifier (U+2203) support across the elaboration and evaluation pipeline, mirroring the existing `forall` implementation at every stage (GAP-003).
2. Positive conformance fixture and evaluator unit tests proving correct elaboration and evaluation semantics.

## Key changes

### Lexer (`crates/core/src/lexer.rs`)
- Added `Token::Exists` variant for U+2203
- Added Unicode match arm `'\u{2203}' => Token::Exists`

### AST (`crates/core/src/ast.rs`)
- Added `RawExpr::Exists { var, domain, body, line }` variant (identical structure to `Forall`)

### Parser (`crates/core/src/parser.rs`)
- Added `Token::Exists` branch in `parse_atom_expr()` producing `RawExpr::Exists`
- Parsing logic identical to Forall: variable, element-of (U+2208), domain, dot, body

### Type Checker (`crates/core/src/pass4_typecheck.rs`)
- Added `RawExpr::Exists` match arm with identical validation to Forall: domain must be List-typed, body type-checked with bound variable

### Serializer (`crates/core/src/pass6_serialize.rs`)
- Added `RawExpr::Exists` serialization arm producing `"quantifier": "exists"` (identical structure to forall)

### Interchange Schema (`docs/interchange-schema.json`)
- Added `ExistsExpr` definition (mirrors ForallExpr with `"quantifier": {"const": "exists"}`)
- Added `ExistsExpr` to `PredicateExpression` oneOf array
- Added `ExistsExpr` to `ExpressionOperand` oneOf array

### Evaluator Types (`crates/eval/src/types.rs`)
- Added `Predicate::Exists { variable, variable_type, domain, body }` variant
- Added `quantifier == "exists"` check in `parse_predicate()` producing `Predicate::Exists`

### Evaluator Predicate Engine (`crates/eval/src/predicate.rs`)
- Added `Predicate::Exists` evaluation: iterates domain elements, short-circuits on first `true`, returns `false` when exhausted (inverse of Forall's short-circuit on first `false`)
- Added two unit tests: `eval_exists_one_match` (true) and `eval_exists_no_match` (false)

### Conformance Fixture
- `conformance/positive/exists_quantifier.tenor`: InspectionItem type with compliant field, exists quantifier checking for non-compliant items
- `conformance/positive/exists_quantifier.expected.json`: Validated against interchange schema

## Self-Check: PASSED

- `cargo build --workspace` -- compiles
- `cargo test --workspace` -- 384 tests pass (including 2 new exists evaluator tests)
- `cargo run -p tenor-cli -- test conformance` -- 61/61 pass (was 60, now 61 with exists_quantifier)
- `cargo run -p tenor-cli -- validate exists_quantifier.expected.json` -- valid
- Manual verify: elaborated JSON contains `"quantifier": "exists"`
- No regressions: all existing forall-based tests pass unchanged

## Key files

### key-files.modified
- `crates/core/src/lexer.rs`
- `crates/core/src/ast.rs`
- `crates/core/src/parser.rs`
- `crates/core/src/pass4_typecheck.rs`
- `crates/core/src/pass6_serialize.rs`
- `docs/interchange-schema.json`
- `crates/eval/src/types.rs`
- `crates/eval/src/predicate.rs`

### key-files.created
- `conformance/positive/exists_quantifier.tenor`
- `conformance/positive/exists_quantifier.expected.json`

## Decisions

- Unicode-only: no ASCII keyword alias for exists (matches forall pattern -- only U+2200 works, not the word "forall")
- Exists short-circuits on first true result (inverse of forall short-circuiting on first false)
- ExistsExpr schema definition is structurally identical to ForallExpr except for `"quantifier": {"const": "exists"}`
